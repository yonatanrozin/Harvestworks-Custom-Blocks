{"version":3,"file":"event-list/view.js","mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,MAAMA,eAAe,GAAGC,MAAM,CAACC,WAAW,CAACC,UAAU,CAACC,GAAG,CAACC,CAAC,IAAI,CAACA,CAAC,CAACC,EAAE,EAAED,CAAC,CAAC,CAAC,CAAC;AAC1E,MAAME,SAAS,GAAGC,QAAQ,CAACC,aAAa,CAAC,yBAAyB,CAAC;AACnE,MAAMC,QAAQ,GAAGC,KAAK,CAACC,IAAI,CAACJ,QAAQ,CAACK,gBAAgB,CAAC,gBAAgB,CAAC,CAAC;;AAExE;AACA,SAASC,uBAAuBA,CAACT,CAAC,EAAE;EAChC,OAAOL,eAAe,CAACe,MAAM,CAACJ,KAAK,CAACC,IAAI,CAACP,CAAC,CAACW,SAAS,CAAC,CAACC,IAAI,CAACC,CAAC,IAAI,UAAU,CAACC,IAAI,CAACD,CAAC,CAAC,CAAC,CAACE,KAAK,CAAC,GAAG,CAAC,CAAC,CAAC,CAAC,CAAC,CAAC;AACvG;AAEA,SAASC,gBAAgBA,CAACC,IAAI,EAAE;EAC5B,IAAI,CAACA,IAAI,EAAE,OAAO,IAAI;EACtB,MAAMC,IAAI,GAAGD,IAAI,CAACE,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;EACjC,MAAMC,KAAK,GAAGH,IAAI,CAACE,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;EACxC,MAAME,GAAG,GAAGJ,IAAI,CAACE,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;EAChC,OAAO,IAAIG,IAAI,CAACJ,IAAI,EAAEE,KAAK,EAAEC,GAAG,CAAC;AACrC;AAEA,SAASE,UAAUA,CAAA,EAAG;EAClB;EACA,MAAMC,SAAS,GAAG,IAAIC,GAAG,CAACC,MAAM,CAACC,QAAQ,CAACC,IAAI,CAAC,CAACC,YAAY,CAACC,GAAG,CAAC,MAAM,CAAC;EACxE,IAAIC,WAAW,GAAG,IAAIT,IAAI,CAACE,SAAS,KAAK,IAAI,GAAGF,IAAI,CAACU,GAAG,CAAC,CAAC,GAAGR,SAAS,CAAC;EACvE,IAAIO,WAAW,IAAI,cAAc,EAAEA,WAAW,GAAG,IAAIT,IAAI,CAAC,CAAC;EAC3DS,WAAW,CAACE,QAAQ,CAAC,CAAC,EAAE,CAAC,EAAE,CAAC,CAAC;EAE7B/B,SAAS,CAACgC,SAAS,GAAG,EAAE;EAExB,MAAMC,SAAS,GAAG,IAAIb,IAAI,CAACS,WAAW,CAAC;EACvCI,SAAS,CAACC,OAAO,CAACL,WAAW,CAACM,OAAO,CAAC,CAAC,GAAG,CAAC,CAAC;EAE5C,KAAK,MAAMC,IAAI,IAAIjC,QAAQ,EAAE;IACzB,MAAM;MAACkC,KAAK;MAAEtB;IAAI,CAAC,GAAGR,uBAAuB,CAAC6B,IAAI,CAAC;IACnD,IAAI,CAACE,SAAS,EAAEC,OAAO,CAAC,GAAGxB,IAAI,CAAClB,GAAG,CAAC2C,CAAC,IAAI1B,gBAAgB,CAAC0B,CAAC,CAAC,EAAEC,OAAO,CAAC,CAAC,CAAC;IACxE,IAAI,CAACF,OAAO,EAAEA,OAAO,GAAGD,SAAS;;IAEjC;IACA,MAAMI,KAAK,GAAGpB,SAAS,GACnBiB,OAAO,IAAIV,WAAW,CAACY,OAAO,CAAC,CAAC,IAAIH,SAAS,GAAGL,SAAS,CAACQ,OAAO,CAAC,CAAC,GACnEF,OAAO,IAAIV,WAAW,CAACY,OAAO,CAAC,CAAC;IAEpC,IAAIC,KAAK,EAAE1C,SAAS,CAAC2C,OAAO,CAACP,IAAI,CAAC;EACtC;AACJ;AAEAf,UAAU,CAAC,CAAC;AAEZG,MAAM,CAACoB,gBAAgB,CAAC,UAAU,EAAEvB,UAAU,CAAC;;AAG/C,8B","sources":["webpack://harvestworks/./src/event-list/view.js"],"sourcesContent":["/**\n * Use this file for JavaScript code that you want to run in the front-end\n * on posts/pages that contain this block.\n *\n * When this file is defined as the value of the `viewScript` property\n * in `block.json` it will be enqueued on the front end of the site.\n *\n * Example:\n *\n * ```js\n * {\n *   \"viewScript\": \"file:./view.js\"\n * }\n * ```\n *\n * If you're not making any changes to this file because your project doesn't need any\n * JavaScript running in the front-end, then you should delete this file and remove\n * the `viewScript` property from `block.json`.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\n\n/* eslint-disable no-console */\n\nconst allEventDetails = Object.fromEntries(event_JSON.map(e => [e.id, e]));\nconst loopBlock = document.querySelector(\".wp-block-post-template\");\nconst allPosts = Array.from(document.querySelectorAll(\".wp-block-post\"));\n\n//look for element class \"post-###\", get the number, lookup in event details\nfunction eventDetailsFromElement(e) {\n    return allEventDetails[Number(Array.from(e.classList).find(c => /post-\\d+/.test(c)).split(\"-\")[1])];\n}\n\nfunction dateFromACFField(date) {\n    if (!date) return null;\n    const year = date.substring(0, 4);\n    const month = date.substring(4, 6) - 1; //JS months counting from 0\n    const day = date.substring(6, 8);\n    return new Date(year, month, day); \n}\n\nfunction filterList() {\n    //get valid searched date from URL, default to current date, ignore time\n    const dateParam = new URL(window.location.href).searchParams.get(\"date\");\n    let searchStart = new Date(dateParam === null ? Date.now() : dateParam);\n    if (searchStart == \"Invalid Date\") searchStart = new Date();\n    searchStart.setHours(0, 0, 0);\n\n    loopBlock.innerHTML = \"\";\n\n    const searchEnd = new Date(searchStart);\n    searchEnd.setDate(searchStart.getDate() + 1);\n\n    for (const post of allPosts) {\n        const {title, date} = eventDetailsFromElement(post);\n        let [startDate, endDate] = date.map(d => dateFromACFField(d)?.valueOf());\n        if (!endDate) endDate = startDate;\n\n        //if a date searched, get events occurring on that day ONLY, else get all upcoming events\n        const match = dateParam?\n            endDate >= searchStart.valueOf() && startDate < searchEnd.valueOf() :\n            endDate >= searchStart.valueOf();\n\n        if (match) loopBlock.prepend(post);\n    }\n}\n\nfilterList();\n\nwindow.addEventListener(\"popstate\", filterList);\n\n\n/* eslint-enable no-console */\n"],"names":["allEventDetails","Object","fromEntries","event_JSON","map","e","id","loopBlock","document","querySelector","allPosts","Array","from","querySelectorAll","eventDetailsFromElement","Number","classList","find","c","test","split","dateFromACFField","date","year","substring","month","day","Date","filterList","dateParam","URL","window","location","href","searchParams","get","searchStart","now","setHours","innerHTML","searchEnd","setDate","getDate","post","title","startDate","endDate","d","valueOf","match","prepend","addEventListener"],"sourceRoot":""}