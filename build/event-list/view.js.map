{"version":3,"file":"event-list/view.js","mappings":";;;;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;;AAEA,MAAMA,SAAS,GAAGC,QAAQ,CAACC,aAAa,CAAC,mCAAmC,CAAC;AAE7E,SAASC,gBAAgBA,CAACC,IAAI,EAAE;EAC5B,IAAI,CAACA,IAAI,EAAE,OAAO,IAAI;EACtB,MAAMC,IAAI,GAAGD,IAAI,CAACE,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;EACjC,MAAMC,KAAK,GAAGH,IAAI,CAACE,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC,GAAG,CAAC,CAAC,CAAC;EACxC,MAAME,GAAG,GAAGJ,IAAI,CAACE,SAAS,CAAC,CAAC,EAAE,CAAC,CAAC;EAChC,OAAO,IAAIG,IAAI,CAACJ,IAAI,EAAEE,KAAK,EAAEC,GAAG,CAAC,CAACE,cAAc,CAAC,SAAS,EAAE;IAAC,OAAO,EAAE,OAAO;IAAE,KAAK,EAAE;EAAS,CAAC,CAAC;AACrG;AAEA,SAASC,SAASA,CAACC,KAAK,EAAE;EAEtB,MAAM;IAACC,UAAU;IAAEC,GAAG;IAAEC,cAAc;IAAEC,IAAI;IAAEC,MAAM;IAAEC;EAAO,CAAC,GAAGN,KAAK;EACtE,MAAM;IAACR,IAAI;IAAEe,QAAQ;IAAEC,QAAQ;IAAEC,UAAU;IAAEC;EAAO,CAAC,GAAGR,GAAG;EAE3D,OAAO;AACX;AACA,cAAcC,cAAc,GAAG,uDAAuDA,cAAc;AACpG,kBAAkBE,MAAM,GAAG,8BAA8BA,MAAM,SAAS,GAAG,EAAE;AAC7E,mBAAmB,GAAG,EAAE;AACxB;AACA;AACA;AACA,gCAAgCd,gBAAgB,CAACC,IAAI,CAAC;AACtD,0BAA0Be,QAAQ,GAAG,mCAAmChB,gBAAgB,CAACgB,QAAQ,CAAC,SAAS,GAAG,EAAE;AAChH;AACA;AACA,+CAA+CE,UAAU,CAAC,CAAC,CAAC,CAACE,IAAI;AACjE;AACA,mDAAmDH,QAAQ;AAC3D;AACA,8CAA8CJ,IAAI;AAClD;AACA,oDAAoDH,UAAU;AAC9D,0BAA0BS,OAAO,GAAG,kCAAkCA,OAAO,SAAS,GAAG,EAAE;AAC3F;AACA;AACA,+CAA+CJ,OAAO;AACtD;AACA;AACA,KAAK;AACL;AAEA,eAAeM,SAASA,CAAA,EAAG;EAEvB,IAAIC,SAAS,GAAG,IAAIC,GAAG,CAACC,MAAM,CAACP,QAAQ,CAACQ,IAAI,CAAC,CAACC,YAAY,CAACC,GAAG,CAAC,MAAM,CAAC;EACtE,MAAMC,QAAQ,GAAG,wBAAwBN,SAAS,GAAG,SAASA,SAAS,EAAE,GAAG,EAAE,EAAE;EAEhF,MAAMO,MAAM,GAAG,MAAM,CAAC,MAAMC,KAAK,CAACF,QAAQ,CAAC,EAAEG,IAAI,CAAC,CAAC;EACnDlC,SAAS,CAACmC,SAAS,GAAGH,MAAM,CAACI,GAAG,CAACC,CAAC,IAAI1B,SAAS,CAAC0B,CAAC,CAAC,CAAC,CAACC,IAAI,CAAC,EAAE,CAAC;AAChE;AAEArC,QAAQ,CAACsC,gBAAgB,CAAC,kBAAkB,EAAEf,SAAS,CAAC;AACxDG,MAAM,CAACY,gBAAgB,CAAC,UAAU,EAAEf,SAAS,CAAC;;AAE9C,8B","sources":["webpack://harvestworks/./src/event-list/view.js"],"sourcesContent":["/**\n * Use this file for JavaScript code that you want to run in the front-end\n * on posts/pages that contain this block.\n *\n * When this file is defined as the value of the `viewScript` property\n * in `block.json` it will be enqueued on the front end of the site.\n *\n * Example:\n *\n * ```js\n * {\n *   \"viewScript\": \"file:./view.js\"\n * }\n * ```\n *\n * If you're not making any changes to this file because your project doesn't need any\n * JavaScript running in the front-end, then you should delete this file and remove\n * the `viewScript` property from `block.json`.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\n\n/* eslint-disable no-console */\n\nconst block_div = document.querySelector(\".wp-block-harvestworks-event-list\");\n\nfunction dateFromACFField(date) {\n    if (!date) return null;\n    const year = date.substring(0, 4);\n    const month = date.substring(4, 6) - 1; //JS months counting from 0\n    const day = date.substring(6, 8);\n    return new Date(year, month, day).toLocaleString('default', {\"month\": \"short\", \"day\": \"2-digit\"}); \n}\n\nfunction eventCard(event) {\n\n    const {post_title, acf, featured_image, guid, status, excerpt} = event;\n    const {date, end_date, location, event_type, artists} = acf;\n\n    return `\n        <div class=\"event_card\">\n            ${featured_image ? `<div class=\"event_img\" style=\"background-image: url(${featured_image})\" >\n                ${status ? `<span class=\"event_status\">${status}</span>` : \"\"}\n            </div>` : \"\"}\n            <div class=\"event_info\">\n                <div class=\"event_details\" >\n                    <span class=\"event_dates\">\n                        <span>${dateFromACFField(date)}</span>\n                        ${end_date ? `<span>&nbsp;—&nbsp;</span><span>${dateFromACFField(end_date)}</span>` : \"\"}\n                    </span>\n                    <span>•</span>\n                    <span class=\"event_type\">${event_type[0].name}</span>\n                    <span>•</span>\n                    <span class=\"event_location\">${location}</span>\n                </div>\n                <a class=\"event_name\" href=\"${guid}\">\n                    <h2>\n                        <span class=\"event_title\">${post_title}</span>\n                        ${artists ? `<span class=\"event_artists\">by ${artists}</span>` : \"\"}\n                    </h2>\n                </a>\n                <p class=\"event_description\">${excerpt}</p>\n            </div>\n        </div>\n    `;\n}\n            \nasync function getEvents() {\n\n    let dateparam = new URL(window.location.href).searchParams.get(\"date\");\n    const queryURL = `/wp-json/wp/v2/events${dateparam ? `?date=${dateparam}` : \"\"}`;\n    \n    const events = await (await fetch(queryURL)).json();\n    block_div.innerHTML = events.map(e => eventCard(e)).join(\"\");\n}\n\ndocument.addEventListener(\"DOMContentLoaded\", getEvents);\nwindow.addEventListener(\"popstate\", getEvents);\n\n/* eslint-enable no-console */\n"],"names":["block_div","document","querySelector","dateFromACFField","date","year","substring","month","day","Date","toLocaleString","eventCard","event","post_title","acf","featured_image","guid","status","excerpt","end_date","location","event_type","artists","name","getEvents","dateparam","URL","window","href","searchParams","get","queryURL","events","fetch","json","innerHTML","map","e","join","addEventListener"],"sourceRoot":""}