(()=>{const n=document.querySelector(".wp-block-harvestworks-event-list");function e(n){if(!n)return null;const e=n.substring(0,4),t=n.substring(4,6)-1,s=n.substring(6,8);return new Date(e,t,s).toLocaleString("default",{month:"short",day:"2-digit"})}function t(n){try{const{post_title:t,acf:s,featured_image:a,guid:i,status:r,excerpt:c}=n,{date:o,time:l,end_date:d,end_time:p,location:v,event_type:w,artists:u}=s;return`\n            <div class="event_card">\n                <a class="event_anchor" href="${i}"></a>\n                <div class="event_img" style="background-image: url(${a})" >\n                    ${r?`<span class="event_status">${r}</span>`:""}\n                </div>\n                <div class="event_info">\n                    <div class="event_details" >\n                        <span class="event_dates">\n                            <span>${e(o)}${l?",":""}</span>\n                            ${l?`<span>${l}</span>`:""}\n                            ${d?`<span>-&nbsp;</span><span>${e(d)}${p?",":""}</span>`:""}\n                            ${p?`<span>${p}</span>`:""}\n                        </span>\n                        <span class='divider'>•</span>\n                        <span class="event_type">${w[0].name}</span>\n                        <span class='divider'>•</span>\n                        <span class="event_location">${v}</span>\n                    </div>\n                    <div class="event_name">\n                        <h2>\n                            <span class="event_title">${t}</span>\n                            ${u?`<span class="event_artists">by ${u}</span>`:""}\n                        </h2>\n                    </div>\n                    <p class="event_description">${c}</p>\n                </div>\n            </div>\n        `}catch(e){return console.error(e.message,n),""}}let s=0,a=!1,i=[];async function r(){s=0,a=!1;let e=new URL(window.location.href).searchParams.get("date");const r="/wp-json/wp/v2/events"+(e?`?date=${e}`:"");i=await(await fetch(r)).json(),i&&"END"===i[0]?a=!0:(Array.isArray(i)||(i=Object.keys(i).map((n=>i[n]))),n.innerHTML=i.map((n=>t(n))).join(""),i.length<10&&c())}async function c(){if(a)return;s++;let e=new URL(window.location.href).searchParams.get("date");e||(e=(new Date).getFullYear()+""+((new Date).getMonth()+1)+(new Date).getDate());let r=parseInt(e.substring(4,6))+s-1;const o=parseInt(e.substring(0,4))+Math.floor(r/12);r=r%12+1,e=o+""+(r<10?"0":"")+r+"01";const l=`/wp-json/wp/v2/events?date=${e}`;newEvents=await(await fetch(l)).json(),newEvents&&"END"===newEvents[0]?a=!0:(Array.isArray(newEvents)||(newEvents=Object.keys(newEvents).map((n=>newEvents[n]))),newEvents=newEvents.filter((function(n,e,t){return!i.includes(n)})),i=[i,newEvents].flat(),n.innerHTML+=newEvents.map((n=>t(n))).join(""),i.length<10&&c())}let o=!1;document.addEventListener("DOMContentLoaded",r),window.addEventListener("popstate",r),window.addEventListener("scroll",(async function(){!o&&window.innerHeight+window.scrollY>=.8*n.clientHeight&&(o=!0,await c(),o=!1)}))})();