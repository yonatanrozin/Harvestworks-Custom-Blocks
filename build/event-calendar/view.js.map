{"version":3,"file":"event-calendar/view.js","mappings":"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","sources":["webpack://harvestworks/./src/event-calendar/view.js"],"sourcesContent":["/**\r\n * Use this file for JavaScript code that you want to run in the front-end\r\n * on posts/pages that contain this block.\r\n *\r\n * When this file is defined as the value of the `viewScript` property\r\n * in `block.json` it will be enqueued on the front end of the site.\r\n *\r\n * Example:\r\n *\r\n * ```js\r\n * {\r\n *   \"viewScript\": \"file:./view.js\"\r\n * }\r\n * ```\r\n *\r\n * If you're not making any changes to this file because your project doesn't need any\r\n * JavaScript running in the front-end, then you should delete this file and remove\r\n * the `viewScript` property from `block.json`.\r\n *\r\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\r\n */\r\n\r\n/* eslint-disable no-console */\r\n\r\nconst offsets = new Array(6).fill(undefined).map(() => {\r\n    const cell = document.createElement(\"div\");\r\n    cell.classList.add(\"calendar_offset\");\r\n    cell.style.height = \"100%\";\r\n    return cell;\r\n})\r\nconst cells = document.querySelectorAll(\".calendar_day\");\r\nconst url = new URL(window.location.href);\r\n\r\n// month/year being viewed on the calendar:\r\n// get from url search params or default to current date\r\nlet dateView = new Date(url.searchParams.get(\"date\") || Date.now()); \r\nif (dateView == \"Invalid Date\") dateView = new Date();\r\n\r\nfunction dateFromACFField(date) {\r\n    if (!date) return null;\r\n    const year = date.substring(0, 4);\r\n    const month = date.substring(4, 6) - 1; //JS months counting from 0\r\n    const day = date.substring(6, 8);\r\n    return new Date(year, month, day); \r\n}\r\n\r\nfunction calendarSetup() {\r\n\r\n    const dateSearch = url.searchParams.get(\"date\"); //queried date from URL searchparams\r\n\r\n    const month = dateView.getMonth();\r\n    const year = dateView.getFullYear();\r\n    \r\n    const daysInMonth = new Date(year, month + 1, 0).getDate();\r\n    for (const cell of cells) {\r\n        if (Number(cell.id) > daysInMonth ) {\r\n            cell.style.display = \"none\";\r\n            continue;\r\n        }\r\n        cell.style.display = \"flex\";\r\n\r\n        const cellDate = new Date(year, month, cell.id);\r\n        const cellDateFormat = cellDate.toISOString().split(\"T\")[0].split(\"-\").join(\"\");\r\n\r\n        const isQueried = dateSearch === cellDateFormat;\r\n\r\n        if (isQueried) {\r\n            cell.classList.add(\"queried\");\r\n        } else cell.classList.remove(\"queried\");\r\n\r\n        function setURLDateQuery() {\r\n            const newParam = cellDate.toISOString().split(\"T\")[0].split(\"-\").join(\"\");\r\n            const oldParam = url.searchParams.get(\"date\");\r\n            if (newParam == oldParam) url.searchParams.delete(\"date\");\r\n            else url.searchParams.set(\"date\", newParam);\r\n            history.pushState({}, \"\", url);\r\n            window.dispatchEvent(new PopStateEvent(\"popstate\"));\r\n        }\r\n\r\n        for (const event of window.events) {\r\n            const eventStart = dateFromACFField(event.start_date).valueOf();\r\n            const eventEnd = event.end_date ? dateFromACFField(event.end_date).valueOf() : eventStart;\r\n            const hasEvent = cellDate.valueOf() >= eventStart && cellDate.valueOf() <= eventEnd;\r\n            if (hasEvent) {\r\n                cell.classList.add(\"has_event\");\r\n                cell.onclick = setURLDateQuery;\r\n                break;\r\n            } else cell.classList.remove(\"has_event\");\r\n        }\r\n    }\r\n\r\n    const firstOfMonth = new Date(year, month, 1).getDay();\r\n\r\n    document.querySelector(\".calendar_day\").style.gridColumnStart = firstOfMonth + 1;\r\n    document.querySelector(\"#calendar_date h3\").innerHTML = \r\n        dateView.toLocaleString(\"default\", {month: \"short\"}) + \" \" +\r\n        dateView.toLocaleString(\"default\", {year: \"numeric\"});\r\n}\r\n\r\nfunction nextMonth() {\r\n    dateView.setMonth(dateView.getMonth() + 1);\r\n    calendarSetup();\r\n}\r\nfunction prevMonth() {\r\n    dateView.setMonth(dateView.getMonth() - 1);\r\n    calendarSetup();\r\n}\r\n\r\ndocument.getElementById(\"nextMonthButton\").addEventListener(\"click\", nextMonth)\r\ndocument.getElementById(\"prevMonthButton\").addEventListener(\"click\", prevMonth)\r\n\r\nwindow.addEventListener(\"popstate\", calendarSetup);\r\ncalendarSetup();\r\n\r\n/* eslint-enable no-console */\r\n"],"names":["offsets","Array","fill","undefined","map","cell","document","createElement","classList","add","style","height","cells","querySelectorAll","url","URL","window","location","href","dateView","Date","searchParams","get","now","dateFromACFField","date","year","substring","month","day","calendarSetup","dateSearch","getMonth","getFullYear","daysInMonth","getDate","Number","id","display","cellDate","cellDateFormat","toISOString","split","join","isQueried","remove","setURLDateQuery","newParam","oldParam","delete","set","history","pushState","dispatchEvent","PopStateEvent","event","events","eventStart","start_date","valueOf","eventEnd","end_date","hasEvent","onclick","firstOfMonth","getDay","querySelector","gridColumnStart","innerHTML","toLocaleString","nextMonth","setMonth","prevMonth","getElementById","addEventListener"],"sourceRoot":""}