{"version":3,"file":"event-calendar/view.js","mappings":"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","sources":["webpack://harvestworks/./src/event-calendar/view.js"],"sourcesContent":["/**\r\n * Use this file for JavaScript code that you want to run in the front-end\r\n * on posts/pages that contain this block.\r\n *\r\n * When this file is defined as the value of the `viewScript` property\r\n * in `block.json` it will be enqueued on the front end of the site.\r\n *\r\n * Example:\r\n *\r\n * ```js\r\n * {\r\n *   \"viewScript\": \"file:./view.js\"\r\n * }\r\n * ```\r\n *\r\n * If you're not making any changes to this file because your project doesn't need any\r\n * JavaScript running in the front-end, then you should delete this file and remove\r\n * the `viewScript` property from `block.json`.\r\n *\r\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\r\n */\r\n\r\n/* eslint-disable no-console */\r\n\r\nconst offsets = new Array(6).fill(undefined).map(() => {\r\n    const cell = document.createElement(\"div\");\r\n    cell.classList.add(\"calendar_offset\");\r\n    cell.style.height = \"100%\";\r\n    return cell;\r\n})\r\nconst cells = document.querySelectorAll(\".calendar_day\");\r\nconst url = new URL(window.location.href);\r\n\r\n// month/year being viewed on the calendar:\r\n// get from url search params or default to current date\r\nlet dateView = dateFromACFField(url.searchParams.get(\"date\")) || new Date();\r\nif (dateView == \"Invalid Date\") dateView = new Date();\r\n\r\nfunction dateFromACFField(date) {\r\n    if (!date) return null;\r\n    const year = date.substring(0, 4);\r\n    const month = date.substring(4, 6) - 1; //JS months counting from 0\r\n    const day = date.substring(6, 8);\r\n    return new Date(year, month, day);\r\n}\r\n\r\nfunction calendarSetup() {\r\n\r\n    const dateSearch = url.searchParams.get(\"date\"); //queried date from URL searchparams\r\n\r\n    console.log(dateView);\r\n\r\n    const month = dateView.getMonth();\r\n    const year = dateView.getFullYear();\r\n\r\n    const daysInMonth = new Date(year, month + 1, 0).getDate();\r\n    for (const cell of cells) {\r\n        if (Number(cell.id) > daysInMonth) {\r\n            cell.style.display = \"none\";\r\n            continue;\r\n        }\r\n        cell.style.display = \"flex\";\r\n\r\n        const cellDate = new Date(year, month, cell.id);\r\n        const cellDateFormat = cellDate.toISOString().split(\"T\")[0].split(\"-\").join(\"\");\r\n\r\n        const isQueried = dateSearch === cellDateFormat;\r\n\r\n        if (isQueried) {\r\n            cell.classList.add(\"queried\");\r\n        } else cell.classList.remove(\"queried\");\r\n\r\n        function setURLDateQuery() {\r\n            const newParam = cellDate.toISOString().split(\"T\")[0].split(\"-\").join(\"\");\r\n            const oldParam = url.searchParams.get(\"date\");\r\n            if (newParam == oldParam) {\r\n                url.searchParams.delete(\"date\");\r\n                window.sessionStorage.removeItem(\"hw_calendar_date\");\r\n            }\r\n            else {\r\n                window.sessionStorage.setItem(\"hw_calendar_date\", newParam);\r\n                url.searchParams.set(\"date\", newParam);\r\n            }\r\n            history.pushState({}, \"\", url);\r\n            window.dispatchEvent(new PopStateEvent(\"popstate\"));\r\n        }\r\n\r\n        for (const event of window.events) {\r\n            const eventStart = dateFromACFField(event.start_date).valueOf();\r\n            const eventEnd = event.end_date ? dateFromACFField(event.end_date).valueOf() : eventStart;\r\n            const hasEvent = cellDate.valueOf() >= eventStart && cellDate.valueOf() <= eventEnd;\r\n            cell.onclick = setURLDateQuery;\r\n            if (hasEvent) {\r\n                cell.classList.add(\"has_event\");\r\n            } else cell.classList.remove(\"has_event\");\r\n\r\n            console.log(event);\r\n        }\r\n    }\r\n\r\n    const firstOfMonth = new Date(year, month, 1).getDay();\r\n\r\n    document.querySelector(\".calendar_day\").style.gridColumnStart = firstOfMonth + 1;\r\n    document.querySelector(\"#calendar_date h3\").innerHTML =\r\n        dateView.toLocaleString(\"default\", { month: \"short\" }) + \" \" +\r\n        dateView.toLocaleString(\"default\", { year: \"numeric\" });\r\n}\r\n\r\nfunction nextMonth() {\r\n    dateView.setMonth(dateView.getMonth() + 1);\r\n    calendarSetup();\r\n}\r\nfunction prevMonth() {\r\n    dateView.setMonth(dateView.getMonth() - 1);\r\n    calendarSetup();\r\n}\r\n\r\ndocument.getElementById(\"nextMonthButton\").addEventListener(\"click\", nextMonth)\r\ndocument.getElementById(\"prevMonthButton\").addEventListener(\"click\", prevMonth)\r\n\r\nwindow.addEventListener(\"popstate\", calendarSetup);\r\ncalendarSetup();\r\n\r\n/* eslint-enable no-console */\r\n"],"names":["offsets","Array","fill","undefined","map","cell","document","createElement","classList","add","style","height","cells","querySelectorAll","url","URL","window","location","href","dateView","dateFromACFField","searchParams","get","Date","date","year","substring","month","day","calendarSetup","dateSearch","console","log","getMonth","getFullYear","daysInMonth","getDate","Number","id","display","cellDate","cellDateFormat","toISOString","split","join","isQueried","remove","setURLDateQuery","newParam","oldParam","delete","sessionStorage","removeItem","setItem","set","history","pushState","dispatchEvent","PopStateEvent","event","events","eventStart","start_date","valueOf","eventEnd","end_date","hasEvent","onclick","firstOfMonth","getDay","querySelector","gridColumnStart","innerHTML","toLocaleString","nextMonth","setMonth","prevMonth","getElementById","addEventListener"],"sourceRoot":""}