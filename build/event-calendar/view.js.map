{"version":3,"file":"event-calendar/view.js","mappings":"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","sources":["webpack://harvestworks/./src/event-calendar/view.js"],"sourcesContent":["/**\n * Use this file for JavaScript code that you want to run in the front-end\n * on posts/pages that contain this block.\n *\n * When this file is defined as the value of the `viewScript` property\n * in `block.json` it will be enqueued on the front end of the site.\n *\n * Example:\n *\n * ```js\n * {\n *   \"viewScript\": \"file:./view.js\"\n * }\n * ```\n *\n * If you're not making any changes to this file because your project doesn't need any\n * JavaScript running in the front-end, then you should delete this file and remove\n * the `viewScript` property from `block.json`.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\n\n/* eslint-disable no-console */\n\nconst offsets = new Array(6).fill(undefined).map(() => {\n    const cell = document.createElement(\"div\");\n    cell.classList.add(\"calendar_offset\");\n    cell.style.height = \"100%\";\n    return cell;\n})\nconst cells = document.querySelectorAll(\".calendar_day\");\nconst url = new URL(window.location.href);\n\n// month/year being viewed on the calendar:\n// get from url search params or default to current date\nlet dateView = dateFromACFField(url.searchParams.get(\"date\")) || new Date();\nif (dateView == \"Invalid Date\") dateView = new Date();\n\nfunction dateFromACFField(date) {\n    if (!date) return null;\n    const year = date.substring(0, 4);\n    const month = date.substring(4, 6) - 1; //JS months counting from 0\n    const day = date.substring(6, 8);\n    return new Date(year, month, day);\n}\n\nfunction calendarSetup() {\n\n    const dateSearch = url.searchParams.get(\"date\"); //queried date from URL searchparams\n\n    console.log(dateView);\n\n    const month = dateView.getMonth();\n    const year = dateView.getFullYear();\n\n    const daysInMonth = new Date(year, month + 1, 0).getDate();\n    for (const cell of cells) {\n        if (Number(cell.id) > daysInMonth) {\n            cell.style.display = \"none\";\n            continue;\n        }\n        cell.style.display = \"flex\";\n\n        const cellDate = new Date(year, month, cell.id);\n        const cellDateFormat = cellDate.toISOString().split(\"T\")[0].split(\"-\").join(\"\");\n\n        const isQueried = dateSearch === cellDateFormat;\n\n        if (isQueried) {\n            cell.classList.add(\"queried\");\n        } else cell.classList.remove(\"queried\");\n\n        function setURLDateQuery() {\n            const newParam = cellDate.toISOString().split(\"T\")[0].split(\"-\").join(\"\");\n            const oldParam = url.searchParams.get(\"date\");\n            if (newParam == oldParam) {\n                url.searchParams.delete(\"date\");\n                window.sessionStorage.removeItem(\"hw_calendar_date\");\n            }\n            else {\n                window.sessionStorage.setItem(\"hw_calendar_date\", newParam);\n                url.searchParams.set(\"date\", newParam);\n            }\n            history.pushState({}, \"\", url);\n            window.dispatchEvent(new PopStateEvent(\"popstate\"));\n        }\n\n        for (const event of window.events) {\n            const eventStart = dateFromACFField(event.start_date).valueOf();\n            const eventEnd = event.end_date ? dateFromACFField(event.end_date).valueOf() : eventStart;\n            const hasEvent = cellDate.valueOf() >= eventStart && cellDate.valueOf() <= eventEnd;\n            cell.onclick = setURLDateQuery;\n            if (hasEvent) {\n                cell.classList.add(\"has_event\");\n                break;\n            } else cell.classList.remove(\"has_event\");\n\n            console.log(event.event_type);\n\n        }\n    }\n\n    const firstOfMonth = new Date(year, month, 1).getDay();\n\n    document.querySelector(\".calendar_day\").style.gridColumnStart = firstOfMonth + 1;\n    document.querySelector(\"#calendar_date h3\").innerHTML =\n        dateView.toLocaleString(\"default\", { month: \"short\" }) + \" \" +\n        dateView.toLocaleString(\"default\", { year: \"numeric\" });\n}\n\nfunction nextMonth() {\n    dateView.setMonth(dateView.getMonth() + 1);\n    calendarSetup();\n}\nfunction prevMonth() {\n    dateView.setMonth(dateView.getMonth() - 1);\n    calendarSetup();\n}\n\ndocument.getElementById(\"nextMonthButton\").addEventListener(\"click\", nextMonth)\ndocument.getElementById(\"prevMonthButton\").addEventListener(\"click\", prevMonth)\n\nwindow.addEventListener(\"popstate\", calendarSetup);\ncalendarSetup();\n\n/* eslint-enable no-console */\n"],"names":["offsets","Array","fill","undefined","map","cell","document","createElement","classList","add","style","height","cells","querySelectorAll","url","URL","window","location","href","dateView","dateFromACFField","searchParams","get","Date","date","year","substring","month","day","calendarSetup","dateSearch","console","log","getMonth","getFullYear","daysInMonth","getDate","Number","id","display","cellDate","cellDateFormat","toISOString","split","join","isQueried","remove","setURLDateQuery","newParam","oldParam","delete","sessionStorage","removeItem","setItem","set","history","pushState","dispatchEvent","PopStateEvent","event","events","eventStart","start_date","valueOf","eventEnd","end_date","hasEvent","onclick","event_type","firstOfMonth","getDay","querySelector","gridColumnStart","innerHTML","toLocaleString","nextMonth","setMonth","prevMonth","getElementById","addEventListener"],"sourceRoot":""}