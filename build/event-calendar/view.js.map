{"version":3,"file":"event-calendar/view.js","mappings":"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","sources":["webpack://harvestworks/./src/event-calendar/view.js"],"sourcesContent":["/**\n * Use this file for JavaScript code that you want to run in the front-end\n * on posts/pages that contain this block.\n *\n * When this file is defined as the value of the `viewScript` property\n * in `block.json` it will be enqueued on the front end of the site.\n *\n * Example:\n *\n * ```js\n * {\n *   \"viewScript\": \"file:./view.js\"\n * }\n * ```\n *\n * If you're not making any changes to this file because your project doesn't need any\n * JavaScript running in the front-end, then you should delete this file and remove\n * the `viewScript` property from `block.json`.\n *\n * @see https://developer.wordpress.org/block-editor/reference-guides/block-api/block-metadata/#view-script\n */\n\n/* eslint-disable no-console */\n\nconst offsets = new Array(6).fill(undefined).map(() => {\n    const cell = document.createElement(\"div\");\n    cell.classList.add(\"calendar_offset\");\n    cell.style.height = \"100%\";\n    return cell;\n})\nconst cells = document.querySelectorAll(\".calendar_day\");\nconst url = new URL(window.location.href);\n\n// month/year being viewed on the calendar:\n// get from url search params or default to current date\nlet dateView = dateFromACFField(url.searchParams.get(\"date\")) || new Date(); \nif (dateView == \"Invalid Date\") dateView = new Date();\n\nfunction dateFromACFField(date) {\n    if (!date) return null;\n    const year = date.substring(0, 4);\n    const month = date.substring(4, 6) - 1; //JS months counting from 0\n    const day = date.substring(6, 8);\n    return new Date(year, month, day); \n}\n\nfunction calendarSetup() {\n\n    const dateSearch = url.searchParams.get(\"date\"); //queried date from URL searchparams\n\n    console.log(dateView);\n\n    const month = dateView.getMonth();\n    const year = dateView.getFullYear();\n    \n    const daysInMonth = new Date(year, month + 1, 0).getDate();\n    for (const cell of cells) {\n        if (Number(cell.id) > daysInMonth ) {\n            cell.style.display = \"none\";\n            continue;\n        }\n        cell.style.display = \"flex\";\n\n        const cellDate = new Date(year, month, cell.id);\n        const cellDateFormat = cellDate.toISOString().split(\"T\")[0].split(\"-\").join(\"\");\n\n        const isQueried = dateSearch === cellDateFormat;\n\n        if (isQueried) {\n            cell.classList.add(\"queried\");\n        } else cell.classList.remove(\"queried\");\n\n        function setURLDateQuery() {\n            const newParam = cellDate.toISOString().split(\"T\")[0].split(\"-\").join(\"\");\n            const oldParam = url.searchParams.get(\"date\");\n            if (newParam == oldParam) url.searchParams.delete(\"date\");\n            else url.searchParams.set(\"date\", newParam);\n            history.pushState({}, \"\", url);\n            window.dispatchEvent(new PopStateEvent(\"popstate\"));\n        }\n\n        for (const event of window.events) {\n            const eventStart = dateFromACFField(event.start_date).valueOf();\n            const eventEnd = event.end_date ? dateFromACFField(event.end_date).valueOf() : eventStart;\n            const hasEvent = cellDate.valueOf() >= eventStart && cellDate.valueOf() <= eventEnd;\n            if (hasEvent) {\n                cell.classList.add(\"has_event\");\n                cell.onclick = setURLDateQuery;\n                break;\n            } else cell.classList.remove(\"has_event\");\n        }\n    }\n\n    const firstOfMonth = new Date(year, month, 1).getDay();\n\n    document.querySelector(\".calendar_day\").style.gridColumnStart = firstOfMonth + 1;\n    document.querySelector(\"#calendar_date h3\").innerHTML = \n        dateView.toLocaleString(\"default\", {month: \"short\"}) + \" \" +\n        dateView.toLocaleString(\"default\", {year: \"numeric\"});\n}\n\nfunction nextMonth() {\n    dateView.setMonth(dateView.getMonth() + 1);\n    calendarSetup();\n}\nfunction prevMonth() {\n    dateView.setMonth(dateView.getMonth() - 1);\n    calendarSetup();\n}\n\ndocument.getElementById(\"nextMonthButton\").addEventListener(\"click\", nextMonth)\ndocument.getElementById(\"prevMonthButton\").addEventListener(\"click\", prevMonth)\n\nwindow.addEventListener(\"popstate\", calendarSetup);\ncalendarSetup();\n\n/* eslint-enable no-console */\n"],"names":["offsets","Array","fill","undefined","map","cell","document","createElement","classList","add","style","height","cells","querySelectorAll","url","URL","window","location","href","dateView","dateFromACFField","searchParams","get","Date","date","year","substring","month","day","calendarSetup","dateSearch","console","log","getMonth","getFullYear","daysInMonth","getDate","Number","id","display","cellDate","cellDateFormat","toISOString","split","join","isQueried","remove","setURLDateQuery","newParam","oldParam","delete","set","history","pushState","dispatchEvent","PopStateEvent","event","events","eventStart","start_date","valueOf","eventEnd","end_date","hasEvent","onclick","firstOfMonth","getDay","querySelector","gridColumnStart","innerHTML","toLocaleString","nextMonth","setMonth","prevMonth","getElementById","addEventListener"],"sourceRoot":""}